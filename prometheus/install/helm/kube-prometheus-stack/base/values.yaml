# Base values for kube-prometheus-stack
# Common configuration shared across all versions and environments
# Override with version-specific and environment-specific values files

prometheus:
  prometheusSpec:
    retention: 15d
    walCompression: true
    # Feature flags (requires Prometheus 2.40+ for native-histograms)
    enableFeatures:
      - exemplar-storage        # Store exemplars in TSDB (link metrics to traces)
      - native-histograms       # Enable native histogram support (more efficient than classic)
    # Exemplar storage limit (default: 100000)
    # Each exemplar ~100 bytes, 100k = ~10MB memory
    exemplars:
      maxSize: 100000           # Max exemplars to store (default: 100000)
    resources:
      requests:
        cpu: 2
        memory: 4Gi
      limits:
        cpu: 4
        memory: 8Gi
    storageSpec:
      volumeClaimTemplate:
        spec:
          accessModes: ["ReadWriteOnce"]
          resources:
            requests:
              storage: 50Gi

alertmanager:
  enabled: true
  alertmanagerSpec:
    retention: 120h
    resources:
      requests:
        cpu: 100m
        memory: 256Mi
      limits:
        cpu: 200m
        memory: 512Mi

grafana:
  enabled: true
  adminPassword: prom-operator
  persistence:
    enabled: true
    size: 10Gi
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi

prometheus-node-exporter:
  enabled: true

kube-state-metrics:
  enabled: true

# Default service monitors
defaultRules:
  create: true
  rules:
    alertmanager: true
    etcd: true
    configReloaders: true
    general: true
    k8s: true
    kubeApiserverAvailability: true
    kubeApiserverBurnrate: true
    kubeApiserverHistogram: true
    kubeApiserverSlos: true
    kubeControllerManager: true
    kubelet: true
    kubeProxy: true
    kubePrometheusGeneral: true
    kubePrometheusNodeRecording: true
    kubernetesApps: true
    kubernetesResources: true
    kubernetesStorage: true
    kubernetesSystem: true
    kubeSchedulerAlerting: true
    kubeSchedulerRecording: true
    kubeStateMetrics: true
    network: true
    node: true
    nodeExporterAlerting: true
    nodeExporterRecording: true
    prometheus: true
    prometheusOperator: true
